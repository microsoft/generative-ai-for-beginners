<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "e2861bbca91c0567ef32bc77fe054f9e",
  "translation_date": "2025-07-09T16:08:48+00:00",
  "source_file": "15-rag-and-vector-databases/README.md",
  "language_code": "ne"
}
-->
# Retrieval Augmented Generation (RAG) рд░ рднреЗрдХреНрдЯрд░ рдбреЗрдЯрд╛рдмреЗрд╕рд╣рд░реВ

[![Retrieval Augmented Generation (RAG) рд░ рднреЗрдХреНрдЯрд░ рдбреЗрдЯрд╛рдмреЗрд╕рд╣рд░реВ](../../../translated_images/15-lesson-banner.ac49e59506175d4fc6ce521561dab2f9ccc6187410236376cfaed13cde371b90.ne.png)](https://aka.ms/gen-ai-lesson15-gh?WT.mc_id=academic-105485-koreyst)

рд╕рд░реНрдЪ рдПрдкреНрд▓рд┐рдХреЗрд╕рдирдХреЛ рдкрд╛рдардорд╛, рд╣рд╛рдореАрд▓реЗ рдЫреЛрдЯрдХрд░реАрдорд╛ рд╕рд┐рдХреНрдпреМрдВ рдХрд┐ рдХрд╕рд░реА рдЖрдлреНрдиреЛ рдбрд╛рдЯрд╛ рдареВрд▓реЛ рднрд╛рд╖рд╛ рдореЛрдбреЗрд▓рд╣рд░реВ (LLMs) рдорд╛ рд╕рдорд╛рд╡реЗрд╢ рдЧрд░реНрдиреЗред рдпрд╕ рдкрд╛рдардорд╛, рд╣рд╛рдореА рдЖрдлреНрдиреЛ LLM рдПрдкреНрд▓рд┐рдХреЗрд╕рдирдорд╛ рдбрд╛рдЯрд╛ рдХрд╕рд░реА рдЖрдзрд╛рд░рднреВрдд рдмрдирд╛рдЙрдиреЗ, рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХрд╕рд░реА рдХрд╛рдо рдЧрд░реНрдЫ рд░ рдбрд╛рдЯрд╛ рднрдгреНрдбрд╛рд░рдг рдЧрд░реНрдиреЗ рддрд░рд┐рдХрд╛рд╣рд░реВ, рдЬрд╕реНрддреИ embeddings рд░ рдЯреЗрдХреНрд╕реНрдЯ рджреБрд╡реИ, рдмрд╛рд░реЗрдорд╛ рдердк рдЧрд╣рд┐рд░рд╛рдЗрдорд╛ рдЬрд╛рдиреНрдЫреМрдВред

> **рднрд┐рдбрд┐рдпреЛ рдЪрд╛рдБрдбреИ рдЖрдЙрдиреЗрдЫ**

## рдкрд░рд┐рдЪрдп

рдпрд╕ рдкрд╛рдардорд╛ рд╣рд╛рдореАрд▓реЗ рдирд┐рдореНрди рд╡рд┐рд╖рдпрд╣рд░реВ рд╕рдореЗрдЯреНрдиреЗрдЫреМрдВ:

- RAG рдХреЗ рд╣реЛ рд░ рдХрд┐рди AI (рдХреГрддреНрд░рд┐рдо рдмреБрджреНрдзрд┐рдорддреНрддрд╛) рдорд╛ рдпрд╕рдХреЛ рдкреНрд░рдпреЛрдЧ рдЧрд░рд┐рдиреНрдЫ рднрдиреНрдиреЗ рдкрд░рд┐рдЪрдпред

- рднреЗрдХреНрдЯрд░ рдбреЗрдЯрд╛рдмреЗрд╕рд╣рд░реВ рдХреЗ рд╣реБрдиреН рдмреБрдЭреНрдиреЗ рд░ рд╣рд╛рдореНрд░реЛ рдПрдкреНрд▓рд┐рдХреЗрд╕рдирдХрд╛ рд▓рд╛рдЧрд┐ рдПрдЙрдЯрд╛ рдмрдирд╛рдЙрдиреЗред

- RAG рд▓рд╛рдИ рдПрдкреНрд▓рд┐рдХреЗрд╕рдирдорд╛ рдХрд╕рд░реА рд╕рдорд╛рд╡реЗрд╢ рдЧрд░реНрдиреЗ рд╡реНрдпрд╛рд╡рд╣рд╛рд░рд┐рдХ рдЙрджрд╛рд╣рд░рдгред

## рд╕рд┐рдХрд╛рдЗрдХрд╛ рд▓рдХреНрд╖реНрдпрд╣рд░реВ

рдпрд╕ рдкрд╛рда рдкреВрд░рд╛ рдЧрд░реЗрдкрдЫрд┐, рддрдкрд╛рдИрдВ рд╕рдХреНрд╖рдо рд╣реБрдиреБрд╣реБрдиреЗрдЫ:

- рдбрд╛рдЯрд╛ рдкреБрдирдГрдкреНрд░рд╛рдкреНрддрд┐ рд░ рдкреНрд░рд╢реЛрдзрдирдорд╛ RAG рдХреЛ рдорд╣рддреНрд╡ рд╡реНрдпрд╛рдЦреНрдпрд╛ рдЧрд░реНрдиред

- RAG рдПрдкреНрд▓рд┐рдХреЗрд╕рди рд╕реЗрдЯрдЕрдк рдЧрд░реНрди рд░ рдЖрдлреНрдиреЛ рдбрд╛рдЯрд╛рд▓рд╛рдИ LLM рдорд╛ рдЖрдзрд╛рд░рднреВрдд рдмрдирд╛рдЙрдиред

- LLM рдПрдкреНрд▓рд┐рдХреЗрд╕рдирд╣рд░реВрдорд╛ RAG рд░ рднреЗрдХреНрдЯрд░ рдбреЗрдЯрд╛рдмреЗрд╕рд╣рд░реВрдХреЛ рдкреНрд░рднрд╛рд╡рдХрд╛рд░реА рд╕рдорд╛рд╡реЗрд╢ред

## рд╣рд╛рдореНрд░реЛ рдкрд░рд┐рджреГрд╢реНрдп: рдЖрдлреНрдиреИ рдбрд╛рдЯрд╛рд╕рдБрдЧ рд╣рд╛рдореНрд░реЛ LLM рд╣рд░реВрд▓рд╛рдИ рд╕рд╢рдХреНрдд рдмрдирд╛рдЙрдБрджреИ

рдпрд╕ рдкрд╛рдардХрд╛ рд▓рд╛рдЧрд┐, рд╣рд╛рдореА рд╣рд╛рдореНрд░реЛ рдЖрдлреНрдиреИ рдиреЛрдЯрд╣рд░реВ рд╢рд┐рдХреНрд╖рд╛ рд╕реНрдЯрд╛рд░реНрдЯрдЕрдкрдорд╛ рдердкреНрди рдЪрд╛рд╣рдиреНрдЫреМрдВ, рдЬрд╕рд▓реЗ рдЪреНрдпрд╛рдЯрдмреЛрдЯрд▓рд╛рдИ рд╡рд┐рднрд┐рдиреНрди рд╡рд┐рд╖рдпрд╣рд░реВрдорд╛ рдердк рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдЧрд░реНрди рдорджреНрджрдд рдЧрд░реНрдЫред рд╣рд╛рдореАрд╕рдБрдЧ рднрдПрдХрд╛ рдиреЛрдЯрд╣рд░реВ рдкреНрд░рдпреЛрдЧ рдЧрд░реЗрд░, рд╕рд┐рдХреНрдиреЗрд╣рд░реВрд▓реЗ рд░рд╛рдореНрд░реЛрд╕рдБрдЧ рдЕрдзреНрдпрдпрди рдЧрд░реНрди рд░ рд╡рд┐рднрд┐рдиреНрди рд╡рд┐рд╖рдпрд╣рд░реВ рдмреБрдЭреНрди рд╕рдХреНрдиреЗрдЫрдиреН, рдЬрд╕рд▓реЗ рдкрд░реАрдХреНрд╖рд╛рдХреЛ рддрдпрд╛рд░реА рд╕рдЬрд┐рд▓реЛ рдмрдирд╛рдЙрдБрдЫред рд╣рд╛рдореНрд░реЛ рдкрд░рд┐рджреГрд╢реНрдп рдмрдирд╛рдЙрди рд╣рд╛рдореАрд▓реЗ рдкреНрд░рдпреЛрдЧ рдЧрд░реНрдиреЗрдЫреМрдВ:

- `Azure OpenAI:` рд╣рд╛рдореНрд░реЛ рдЪреНрдпрд╛рдЯрдмреЛрдЯ рдмрдирд╛рдЙрди рдкреНрд░рдпреЛрдЧ рд╣реБрдиреЗ LLM

- `AI for beginners' lesson on Neural Networks:` рдпреЛ рдбрд╛рдЯрд╛ рд╣реЛ рдЬрд╕рдорд╛ рд╣рд╛рдореА рд╣рд╛рдореНрд░реЛ LLM рд▓рд╛рдИ рдЖрдзрд╛рд░рднреВрдд рдмрдирд╛рдЙрдиреЗрдЫреМрдВ

- `Azure AI Search` рд░ `Azure Cosmos DB:` рд╣рд╛рдореНрд░реЛ рдбрд╛рдЯрд╛ рднрдгреНрдбрд╛рд░рдг рдЧрд░реНрди рд░ рд╕рд░реНрдЪ рдЗрдиреНрдбреЗрдХреНрд╕ рдмрдирд╛рдЙрди рдкреНрд░рдпреЛрдЧ рд╣реБрдиреЗ рднреЗрдХреНрдЯрд░ рдбреЗрдЯрд╛рдмреЗрд╕

рдкреНрд░рдпреЛрдЧрдХрд░реНрддрд╛рд╣рд░реВрд▓реЗ рдЖрдлреНрдирд╛ рдиреЛрдЯрд╣рд░реВрдмрд╛рдЯ рдЕрднреНрдпрд╛рд╕ рдХреНрд╡рд┐рдЬрд╣рд░реВ рдмрдирд╛рдЙрди, рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐ рдлреНрд▓реНрдпрд╛рд╕ рдХрд╛рд░реНрдбрд╣рд░реВ рддрдпрд╛рд░ рдкрд╛рд░реНрди рд░ рд╕рдВрдХреНрд╖рд┐рдкреНрдд рд╕рд╛рд░рд╛рдВрд╢рд╣рд░реВ рдмрдирд╛рдЙрди рд╕рдХреНрдиреЗрдЫрдиреНред рд╕реБрд░реБ рдЧрд░реНрдирдХрд╛ рд▓рд╛рдЧрд┐, RAG рдХреЗ рд╣реЛ рд░ рдХрд╕рд░реА рдХрд╛рдо рдЧрд░реНрдЫ рд╣реЗрд░реНрдиреБрд╣реЛрд╕реН:

## Retrieval Augmented Generation (RAG)

LLM рд╕рдВрдЪрд╛рд▓рд┐рдд рдЪреНрдпрд╛рдЯрдмреЛрдЯрд▓реЗ рдкреНрд░рдпреЛрдЧрдХрд░реНрддрд╛рдХреЛ рдкреНрд░рд╢реНрдирд╣рд░реВрд▓рд╛рдИ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдЧрд░реА рдЬрд╡рд╛рдлрд╣рд░реВ рдЙрддреНрдкрд╛рджрди рдЧрд░реНрдЫред рдпреЛ рдЕрдиреНрддрд░рдХреНрд░рд┐рдпрд╛рддреНрдордХ рд╣реБрди рдбрд┐рдЬрд╛рдЗрди рдЧрд░рд┐рдПрдХреЛ рдЫ рд░ рдкреНрд░рдпреЛрдЧрдХрд░реНрддрд╛рд╕рдБрдЧ рд╡рд┐рднрд┐рдиреНрди рд╡рд┐рд╖рдпрд╣рд░реВрдорд╛ рд╕рдВрд╡рд╛рдж рдЧрд░реНрдЫред рддрд░ рдпрд╕рдХреЛ рдЬрд╡рд╛рдлрд╣рд░реВ рдкреНрд░рджрд╛рди рдЧрд░рд┐рдПрдХреЛ рд╕рдиреНрджрд░реНрдн рд░ рдпрд╕рдХреЛ рдЖрдзрд╛рд░рднреВрдд рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдбрд╛рдЯрд╛рдорд╛ рд╕реАрдорд┐рдд рд╣реБрдиреНрдЫрдиреНред рдЙрджрд╛рд╣рд░рдгрдХрд╛ рд▓рд╛рдЧрд┐, GPT-4 рдХреЛ рдЬреНрдЮрд╛рди рдХрдЯрдЕрдл рд╕реЗрдкреНрдЯреЗрдореНрдмрд░ 2021 рд╣реЛ, рдЬрд╕рдХреЛ рдЕрд░реНрде рдпреЛ рд╕рдордпрдкрдЫрд┐ рднрдПрдХрд╛ рдШрдЯрдирд╛рд╣рд░реВрдХреЛ рдЬрд╛рдирдХрд╛рд░реА рдЫреИрдиред рд╕рд╛рдереИ, LLM рдкреНрд░рд╢рд┐рдХреНрд╖рдгрдорд╛ рдкреНрд░рдпреЛрдЧ рдЧрд░рд┐рдПрдХреЛ рдбрд╛рдЯрд╛рдорд╛ рд╡реНрдпрдХреНрддрд┐рдЧрдд рдиреЛрдЯрд╣рд░реВ рд╡рд╛ рдХрдореНрдкрдиреАрдХреЛ рдЙрддреНрдкрд╛рджрди рдореНрдпрд╛рдиреБрдЕрд▓ рдЬрд╕реНрддрд╛ рдЧреЛрдкреНрдп рдЬрд╛рдирдХрд╛рд░реАрд╣рд░реВ рд╕рдорд╛рд╡реЗрд╢ рд╣реБрдБрджреИрдирдиреНред

### RAG (Retrieval Augmented Generation) рдХрд╕рд░реА рдХрд╛рдо рдЧрд░реНрдЫ

![RAG рдХрд╕рд░реА рдХрд╛рдо рдЧрд░реНрдЫ рджреЗрдЦрд╛рдЙрдиреЗ рдЪрд┐рддреНрд░](../../../translated_images/how-rag-works.f5d0ff63942bd3a638e7efee7a6fce7f0787f6d7a1fca4e43f2a7a4d03cde3e0.ne.png)

рдорд╛рдиреМрдВ рддрдкрд╛рдИрдВрд▓реЗ рдЖрдлреНрдиреЛ рдиреЛрдЯрд╣рд░реВрдмрд╛рдЯ рдХреНрд╡рд┐рдЬрд╣рд░реВ рдмрдирд╛рдЙрдиреЗ рдЪреНрдпрд╛рдЯрдмреЛрдЯ рддреИрдирд╛рде рдЧрд░реНрди рдЪрд╛рд╣рдиреБрд╣реБрдиреНрдЫ, рддрдм рддрдкрд╛рдИрдВрд▓рд╛рдИ рдЬреНрдЮрд╛рди рдЖрдзрд╛рд░рд╕рдБрдЧ рдЬрдбрд╛рди рдЖрд╡рд╢реНрдпрдХ рдкрд░реНрдЫред рдпрд╣реАрдБ RAG рдорджреНрджрдд рдЧрд░реНрдЫред RAG рдпрд╕рд░реА рдХрд╛рдо рдЧрд░реНрдЫ:

- **рдЬреНрдЮрд╛рди рдЖрдзрд╛рд░:** рдкреБрдирдГрдкреНрд░рд╛рдкреНрддрд┐ рдЕрдШрд┐, рдпреА рдХрд╛рдЧрдЬрд╛рддрд╣рд░реВрд▓рд╛рдИ рд╕рдЩреНрдХрд▓рди рд░ рдкреВрд░реНрд╡рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдЧрд░реНрдиреБрдкрд░реНрдЫ, рд╕рд╛рдорд╛рдиреНрдпрддрдпрд╛ рдареВрд▓реЛ рдХрд╛рдЧрдЬрд╛рддрд▓рд╛рдИ рд╕рд╛рдирд╛ рднрд╛рдЧрд╣рд░реВрдорд╛ рд╡рд┐рднрд╛рдЬрди рдЧрд░реА, рддрд┐рдиреАрд╣рд░реВрд▓рд╛рдИ рдЯреЗрдХреНрд╕реНрдЯ embedding рдорд╛ рд░реВрдкрд╛рдиреНрддрд░рдг рдЧрд░реА рдбреЗрдЯрд╛рдмреЗрд╕рдорд╛ рднрдгреНрдбрд╛рд░рдг рдЧрд░рд┐рдиреНрдЫред

- **рдкреНрд░рдпреЛрдЧрдХрд░реНрддрд╛ рдкреНрд░рд╢реНрди:** рдкреНрд░рдпреЛрдЧрдХрд░реНрддрд╛рд▓реЗ рдкреНрд░рд╢реНрди рд╕реЛрдзреНрдЫред

- **рдкреБрдирдГрдкреНрд░рд╛рдкреНрддрд┐:** рдкреНрд░рдпреЛрдЧрдХрд░реНрддрд╛рд▓реЗ рдкреНрд░рд╢реНрди рд╕реЛрдзреНрджрд╛, embedding рдореЛрдбреЗрд▓рд▓реЗ рд╣рд╛рдореНрд░реЛ рдЬреНрдЮрд╛рди рдЖрдзрд╛рд░рдмрд╛рдЯ рд╕рд╛рдиреНрджрд░реНрднрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдЦреЛрдЬреНрдЫ рд░ рдердк рд╕рдиреНрджрд░реНрдн рдкреНрд░рджрд╛рди рдЧрд░реНрдЫ рдЬреБрди рдкреНрд░реЙрдореНрдкреНрдЯрдорд╛ рд╕рдорд╛рд╡реЗрд╢ рдЧрд░рд┐рдиреНрдЫред

- **рд╡реГрджреНрдзрд┐ рдЧрд░рд┐рдПрдХреЛ рдЙрддреНрдкрд╛рджрди:** LLM рд▓реЗ рдкреНрд░рд╛рдкреНрдд рдбрд╛рдЯрд╛рдХреЛ рдЖрдзрд╛рд░рдорд╛ рдЖрдлреНрдиреЛ рдЬрд╡рд╛рдл рд╕реБрдзрд╛рд░ рдЧрд░реНрдЫред рдпрд╕рд▓реЗ рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдбрд╛рдЯрд╛ рдорд╛рддреНрд░ рдирднрдИ рдердкрд┐рдПрдХреЛ рд╕рдиреНрджрд░реНрднрдмрд╛рдЯ рдкреНрд░рд╛рдкреНрдд рд╕рд╛рдиреНрджрд░реНрднрд┐рдХ рдЬрд╛рдирдХрд╛рд░реАрдорд╛ рдЖрдзрд╛рд░рд┐рдд рдЬрд╡рд╛рдл рджрд┐рди рдЕрдиреБрдорддрд┐ рджрд┐рдиреНрдЫред LLM рд▓реЗ рддреНрдпрд╕рдкрдЫрд┐ рдкреНрд░рдпреЛрдЧрдХрд░реНрддрд╛рдХреЛ рдкреНрд░рд╢реНрдирдХреЛ рдЬрд╡рд╛рдл рдлрд░реНрдХрд╛рдЙрдБрдЫред

![RAG рдХреЛ рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░ рджреЗрдЦрд╛рдЙрдиреЗ рдЪрд┐рддреНрд░](../../../translated_images/encoder-decode.f2658c25d0eadee2377bb28cf3aee8b67aa9249bf64d3d57bb9be077c4bc4e1a.ne.png)

RAG рдХреЛ рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░ рдЯреНрд░рд╛рдиреНрд╕рдлрд░реНрдорд░рд╣рд░реВ рдкреНрд░рдпреЛрдЧ рдЧрд░реЗрд░ рджреБрдИ рднрд╛рдЧрдорд╛ рдмрдирд╛рдЗрдПрдХреЛ рд╣реБрдиреНрдЫ: рдПрдХ encoder рд░ рдПрдХ decoderред рдЙрджрд╛рд╣рд░рдгрдХрд╛ рд▓рд╛рдЧрд┐, рдкреНрд░рдпреЛрдЧрдХрд░реНрддрд╛рд▓реЗ рдкреНрд░рд╢реНрди рд╕реЛрдзреНрджрд╛, рдЗрдирдкреБрдЯ рдЯреЗрдХреНрд╕реНрдЯрд▓рд╛рдИ рд╢рдмреНрджрд╣рд░реВрдХреЛ рдЕрд░реНрде рд╕рдореЗрдЯреНрдиреЗ рднреЗрдХреНрдЯрд░рд╣рд░реВрдорд╛ 'encode' рдЧрд░рд┐рдиреНрдЫ рд░ рддреА рднреЗрдХреНрдЯрд░рд╣рд░реВрд▓рд╛рдИ рд╣рд╛рдореНрд░реЛ рдХрд╛рдЧрдЬрд╛рдд рдЗрдиреНрдбреЗрдХреНрд╕рдорд╛ 'decode' рдЧрд░реА рдкреНрд░рдпреЛрдЧрдХрд░реНрддрд╛рдХреЛ рдкреНрд░рд╢реНрдирдорд╛ рдЖрдзрд╛рд░рд┐рдд рдирдпрд╛рдБ рдЯреЗрдХреНрд╕реНрдЯ рдЙрддреНрдкрд╛рджрди рдЧрд░рд┐рдиреНрдЫред LLM рд▓реЗ рдЖрдЙрдЯрдкреБрдЯ рдЙрддреНрдкрд╛рджрди рдЧрд░реНрди encoder-decoder рдореЛрдбреЗрд▓ рджреБрд╡реИ рдкреНрд░рдпреЛрдЧ рдЧрд░реНрдЫред

рдкреНрд░рд╕реНрддрд╛рд╡рд┐рдд рдХрд╛рдЧрдЬрд╛рдд рдЕрдиреБрд╕рд╛рд░ RAG рд▓рд╛рдЧреВ рдЧрд░реНрджрд╛ рджреБрдИ рддрд░рд┐рдХрд╛ рдЫрдиреН: [Retrieval-Augmented Generation for Knowledge intensive NLP Tasks](https://arxiv.org/pdf/2005.11401.pdf?WT.mc_id=academic-105485-koreyst):

- **_RAG-Sequence_**: рдкреНрд░рд╛рдкреНрдд рдХрд╛рдЧрдЬрд╛рддрд╣рд░реВ рдкреНрд░рдпреЛрдЧ рдЧрд░реЗрд░ рдкреНрд░рдпреЛрдЧрдХрд░реНрддрд╛рдХреЛ рдкреНрд░рд╢реНрдирдХреЛ рд╕рдмреИрднрдиреНрджрд╛ рдЙрдкрдпреБрдХреНрдд рдЬрд╡рд╛рдл рдЕрдиреБрдорд╛рди рд▓рдЧрд╛рдЙрдиреЗред

- **RAG-Token**: рдХрд╛рдЧрдЬрд╛рддрд╣рд░реВ рдкреНрд░рдпреЛрдЧ рдЧрд░реЗрд░ рдЕрд░реНрдХреЛ рдЯреЛрдХрди рдЙрддреНрдкрд╛рджрди рдЧрд░реНрдиреЗ, рддреНрдпрд╕рдкрдЫрд┐ рдкреНрд░рдпреЛрдЧрдХрд░реНрддрд╛рдХреЛ рдкреНрд░рд╢реНрдирдХреЛ рдЬрд╡рд╛рдл рджрд┐рди рддрд┐рдиреАрд╣рд░реВрд▓рд╛рдИ рдкреБрдирдГрдкреНрд░рд╛рдкреНрдд рдЧрд░реНрдиреЗред

### рдХрд┐рди RAG рдкреНрд░рдпреЛрдЧ рдЧрд░реНрдиреЗ?

- **рдЬрд╛рдирдХрд╛рд░реАрдХреЛ рд╕рдореГрджреНрдзрд┐:** рдЯреЗрдХреНрд╕реНрдЯ рдЬрд╡рд╛рдлрд╣рд░реВ рдЕрджреНрдпрд╛рд╡рдзрд┐рдХ рд░ рд╡рд░реНрддрдорд╛рди рд░рд╛рдЦреНрдЫред рдпрд╕рд▓реЗ рдбреЛрдореЗрди-рд╡рд┐рд╢реЗрд╖ рдХрд╛рд░реНрдпрд╣рд░реВрдорд╛ рдкреНрд░рджрд░реНрд╢рди рд╕реБрдзрд╛рд░ рдЧрд░реНрдЫ рдХрд┐рдирднрдиреЗ рдпрд╕рд▓реЗ рдЖрдиреНрддрд░рд┐рдХ рдЬреНрдЮрд╛рди рдЖрдзрд╛рд░рдорд╛ рдкрд╣реБрдБрдЪ рджрд┐рдиреНрдЫред

- **рдЧрд▓рдд рдЬрд╛рдирдХрд╛рд░реА рдХрдо рдЧрд░реНрдиреЗ:** рдЬреНрдЮрд╛рди рдЖрдзрд╛рд░рдорд╛ рд░рд╣реЗрдХреЛ **рдкрд░реАрдХреНрд╖рдгрдпреЛрдЧреНрдп рдбрд╛рдЯрд╛** рдкреНрд░рдпреЛрдЧ рдЧрд░реЗрд░ рдкреНрд░рдпреЛрдЧрдХрд░реНрддрд╛рдХреЛ рдкреНрд░рд╢реНрдирд▓рд╛рдИ рд╕рдиреНрджрд░реНрдн рдкреНрд░рджрд╛рди рдЧрд░реНрдЫред

- **рд▓рд╛рдЧрдд-рдХреБрд╢рд▓:** LLM рд▓рд╛рдИ рдлрд╛рдЗрди-рдЯреНрдпреБрди рдЧрд░реНрдиреЗ рднрдиреНрджрд╛ рдпреЛ рдЕрдзрд┐рдХ рдЖрд░реНрдерд┐рдХ рд╣реБрдиреНрдЫред

## рдЬреНрдЮрд╛рди рдЖрдзрд╛рд░ рд╕рд┐рд░реНрдЬрдирд╛ рдЧрд░реНрджреИ

рд╣рд╛рдореНрд░реЛ рдПрдкреНрд▓рд┐рдХреЗрд╕рди рд╣рд╛рдореНрд░реЛ рд╡реНрдпрдХреНрддрд┐рдЧрдд рдбрд╛рдЯрд╛рдорд╛ рдЖрдзрд╛рд░рд┐рдд рдЫ, рдЬрд╕реНрддреИ AI For Beginners рдХреЛ Neural Network рдкрд╛рдаред

### рднреЗрдХреНрдЯрд░ рдбреЗрдЯрд╛рдмреЗрд╕рд╣рд░реВ

рдкрд░рдореНрдкрд░рд╛рдЧрдд рдбреЗрдЯрд╛рдмреЗрд╕рд╣рд░реВ рднрдиреНрджрд╛ рдлрд░рдХ, рднреЗрдХреНрдЯрд░ рдбреЗрдЯрд╛рдмреЗрд╕рд╣рд░реВ рд╡рд┐рд╢реЗрд╖ рдЧрд░реА embedded рднреЗрдХреНрдЯрд░рд╣рд░реВ рднрдгреНрдбрд╛рд░рдг, рд╡реНрдпрд╡рд╕реНрдерд╛рдкрди рд░ рдЦреЛрдЬ рдЧрд░реНрди рдбрд┐рдЬрд╛рдЗрди рдЧрд░рд┐рдПрдХрд╛ рдбреЗрдЯрд╛рдмреЗрд╕ рд╣реБрдиреНред рдпрд╕рд▓реЗ рдХрд╛рдЧрдЬрд╛рддрд╣рд░реВрдХреЛ рд╕рдЩреНрдЦреНрдпрд╛рддреНрдордХ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рднрдгреНрдбрд╛рд░рдг рдЧрд░реНрдЫред рдбрд╛рдЯрд╛рд▓рд╛рдИ рд╕рдЩреНрдЦреНрдпрд╛рддреНрдордХ embeddings рдорд╛ рд╡рд┐рднрд╛рдЬрди рдЧрд░реНрджрд╛ рд╣рд╛рдореНрд░реЛ AI рдкреНрд░рдгрд╛рд▓реАрд▓рд╛рдИ рдбрд╛рдЯрд╛ рдмреБрдЭреНрди рд░ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдЧрд░реНрди рд╕рдЬрд┐рд▓реЛ рд╣реБрдиреНрдЫред

рд╣рд╛рдореА embeddings рд▓рд╛рдИ рднреЗрдХреНрдЯрд░ рдбреЗрдЯрд╛рдмреЗрд╕рд╣рд░реВрдорд╛ рднрдгреНрдбрд╛рд░рдг рдЧрд░реНрдЫреМрдВ рдХрд┐рдирднрдиреЗ LLM рд╣рд░реВрд▓реЗ рд╕реНрд╡реАрдХрд╛рд░ рдЧрд░реНрдиреЗ рдЯреЛрдХрдирд╣рд░реВрдХреЛ рд╕рдВрдЦреНрдпрд╛ рд╕реАрдорд┐рдд рд╣реБрдиреНрдЫред рд╕рдореНрдкреВрд░реНрдг embeddings LLM рдорд╛ рдкрдард╛рдЙрди рдирд╕рдХрд┐рдиреЗ рднрдПрдХрд╛рд▓реЗ, рд╣рд╛рдореАрд▓реЗ рддрд┐рдиреАрд╣рд░реВрд▓рд╛рдИ рд╕рд╛рдирд╛ рднрд╛рдЧрд╣рд░реВрдорд╛ рд╡рд┐рднрд╛рдЬрди рдЧрд░реНрдиреБрдкрд░реНрдЫ рд░ рдкреНрд░рдпреЛрдЧрдХрд░реНрддрд╛рд▓реЗ рдкреНрд░рд╢реНрди рд╕реЛрдзреНрджрд╛, рд╕рдмреИрднрдиреНрджрд╛ рдорд┐рд▓реНрджреЛрдЬреБрд▓реНрджреЛ embeddings рдкреНрд░реЙрдореНрдкреНрдЯрд╕рдБрдЧреИ рдлрд░реНрдХрд╛рдЗрдиреНрдЫред chunking рд▓реЗ LLM рдорд╛рд░реНрдлрдд рдкрдард╛рдЗрдиреЗ рдЯреЛрдХрдирд╣рд░реВрдХреЛ рд╕рдВрдЦреНрдпрд╛ рдШрдЯрд╛рдПрд░ рд▓рд╛рдЧрдд рдкрдирд┐ рдХрдо рдЧрд░реНрдЫред

рдХреЗрд╣реА рд▓реЛрдХрдкреНрд░рд┐рдп рднреЗрдХреНрдЯрд░ рдбреЗрдЯрд╛рдмреЗрд╕рд╣рд░реВрдорд╛ Azure Cosmos DB, Clarifyai, Pinecone, Chromadb, ScaNN, Qdrant рд░ DeepLake рд╕рдорд╛рд╡реЗрд╢ рдЫрдиреНред рддрдкрд╛рдИрдВ Azure CLI рдкреНрд░рдпреЛрдЧ рдЧрд░реЗрд░ Azure Cosmos DB рдореЛрдбреЗрд▓ рдирд┐рдореНрди рдЖрджреЗрд╢рдмрд╛рдЯ рдмрдирд╛рдЙрди рд╕рдХреНрдиреБрд╣реБрдиреНрдЫ:

```bash
az login
az group create -n <resource-group-name> -l <location>
az cosmosdb create -n <cosmos-db-name> -r <resource-group-name>
az cosmosdb list-keys -n <cosmos-db-name> -g <resource-group-name>
```

### рдЯреЗрдХреНрд╕реНрдЯрдмрд╛рдЯ embeddings рд╕рдореНрдо

рд╣рд╛рдореАрд▓реЗ рдбрд╛рдЯрд╛ рднрдгреНрдбрд╛рд░рдг рдЧрд░реНрдиреБ рдЕрдШрд┐, рдпрд╕рд▓рд╛рдИ рднреЗрдХреНрдЯрд░ embeddings рдорд╛ рд░реВрдкрд╛рдиреНрддрд░рдг рдЧрд░реНрдиреБрдкрд░реНрдЫред рдпрджрд┐ рддрдкрд╛рдИрдВ рдареВрд▓реЛ рдХрд╛рдЧрдЬрд╛рдд рд╡рд╛ рд▓рд╛рдореЛ рдЯреЗрдХреНрд╕реНрдЯрд╕рдБрдЧ рдХрд╛рдо рдЧрд░реНрджреИ рд╣реБрдиреБрд╣реБрдиреНрдЫ рднрдиреЗ, рддрдкрд╛рдИрдВрд▓реЗ рдЕрдкреЗрдХреНрд╖рд┐рдд рдкреНрд░рд╢реНрдирд╣рд░реВрдХрд╛ рдЖрдзрд╛рд░рдорд╛ рддрд┐рдиреАрд╣рд░реВрд▓рд╛рдИ chunk рдЧрд░реНрди рд╕рдХреНрдиреБрд╣реБрдиреНрдЫред chunking рд╡рд╛рдХреНрдп рд╕реНрддрд░рдорд╛ рд╡рд╛ рдЕрдиреБрдЪреНрдЫреЗрдж рд╕реНрддрд░рдорд╛ рдЧрд░реНрди рд╕рдХрд┐рдиреНрдЫред chunking рд▓реЗ рд╡рд░рд┐рдкрд░рд┐рдХрд╛ рд╢рдмреНрджрд╣рд░реВрдмрд╛рдЯ рдЕрд░реНрде рдирд┐рдХрд╛рд▓реНрдиреЗ рднрдПрдХрд╛рд▓реЗ, рддрдкрд╛рдИрдВ chunk рдорд╛ рдердк рд╕рдиреНрджрд░реНрдн рдердкреНрди рд╕рдХреНрдиреБрд╣реБрдиреНрдЫ, рдЬрд╕реНрддреИ рдХрд╛рдЧрдЬрд╛рддрдХреЛ рд╢реАрд░реНрд╖рдХ рд╡рд╛ chunk рдЕрдШрд┐ рд╡рд╛ рдкрдЫрд┐ рдХреЗрд╣реА рдЯреЗрдХреНрд╕реНрдЯ рд╕рдорд╛рд╡реЗрд╢ рдЧрд░реЗрд░ред рддрдкрд╛рдИрдВ рдпрд╕рд░реА рдбрд╛рдЯрд╛ chunk рдЧрд░реНрди рд╕рдХреНрдиреБрд╣реБрдиреНрдЫ:

```python
def split_text(text, max_length, min_length):
    words = text.split()
    chunks = []
    current_chunk = []

    for word in words:
        current_chunk.append(word)
        if len(' '.join(current_chunk)) < max_length and len(' '.join(current_chunk)) > min_length:
            chunks.append(' '.join(current_chunk))
            current_chunk = []

    # If the last chunk didn't reach the minimum length, add it anyway
    if current_chunk:
        chunks.append(' '.join(current_chunk))

    return chunks
```

chunk рдЧрд░реЗрдкрдЫрд┐, рд╣рд╛рдореА рд╡рд┐рднрд┐рдиреНрди embedding рдореЛрдбреЗрд▓рд╣рд░реВ рдкреНрд░рдпреЛрдЧ рдЧрд░реЗрд░ рдЯреЗрдХреНрд╕реНрдЯрд▓рд╛рдИ embed рдЧрд░реНрди рд╕рдХреНрдЫреМрдВред рдХреЗрд╣реА рдореЛрдбреЗрд▓рд╣рд░реВрдорд╛ word2vec, OpenAI рдХреЛ ada-002, Azure Computer Vision рд░ рдЕрдиреНрдп рдзреЗрд░реИ рд╕рдорд╛рд╡реЗрд╢ рдЫрдиреНред рдХреБрди рдореЛрдбреЗрд▓ рдкреНрд░рдпреЛрдЧ рдЧрд░реНрдиреЗ рднрдиреНрдиреЗ рдХреБрд░рд╛ рддрдкрд╛рдИрдВрд▓реЗ рдкреНрд░рдпреЛрдЧ рдЧрд░реНрдиреЗ рднрд╛рд╖рд╛, рд╕рдорд╛рд╡реЗрд╢ рдЧрд░рд┐рдПрдХреЛ рд╕рд╛рдордЧреНрд░реАрдХреЛ рдкреНрд░рдХрд╛рд░ (рдЯреЗрдХреНрд╕реНрдЯ/рдЫрд╡рд┐/рдЕрдбрд┐рдпреЛ), рдЗрдирдкреБрдЯрдХреЛ рдЖрдХрд╛рд░ рд░ embedding рдЖрдЙрдЯрдкреБрдЯрдХреЛ рд▓рдореНрдмрд╛рдЗрдорд╛ рдирд┐рд░реНрднрд░ рдЧрд░реНрджрдЫред

OpenAI рдХреЛ `text-embedding-ada-002` рдореЛрдбреЗрд▓ рдкреНрд░рдпреЛрдЧ рдЧрд░реЗрд░ embed рдЧрд░рд┐рдПрдХреЛ рдЯреЗрдХреНрд╕реНрдЯрдХреЛ рдЙрджрд╛рд╣рд░рдг:

![cat рд╢рдмреНрджрдХреЛ embedding](../../../translated_images/cat.74cbd7946bc9ca380a8894c4de0c706a4f85b16296ffabbf52d6175df6bf841e.ne.png)

## рдкреБрдирдГрдкреНрд░рд╛рдкреНрддрд┐ рд░ рднреЗрдХреНрдЯрд░ рдЦреЛрдЬ

рдкреНрд░рдпреЛрдЧрдХрд░реНрддрд╛рд▓реЗ рдкреНрд░рд╢реНрди рд╕реЛрдзреНрджрд╛, retriever рд▓реЗ рдпрд╕рд▓рд╛рдИ query encoder рдкреНрд░рдпреЛрдЧ рдЧрд░реА рднреЗрдХреНрдЯрд░рдорд╛ рд░реВрдкрд╛рдиреНрддрд░рдг рдЧрд░реНрдЫ, рддреНрдпрд╕рдкрдЫрд┐ рд╣рд╛рдореНрд░реЛ рдХрд╛рдЧрдЬрд╛рдд рд╕рд░реНрдЪ рдЗрдиреНрдбреЗрдХреНрд╕рдорд╛ рд╕рдореНрдмрдиреНрдзрд┐рдд рднреЗрдХреНрдЯрд░рд╣рд░реВ рдЦреЛрдЬреНрдЫ рдЬреБрди рдЗрдирдкреБрдЯрд╕рдБрдЧ рдореЗрд▓ рдЦрд╛рдиреНрдЫред рдкреВрд░рд╛ рднрдПрдкрдЫрд┐, рдпреЛ рдЗрдирдкреБрдЯ рднреЗрдХреНрдЯрд░ рд░ рдХрд╛рдЧрдЬрд╛рдд рднреЗрдХреНрдЯрд░рд╣рд░реВрд▓рд╛рдИ рдЯреЗрдХреНрд╕реНрдЯрдорд╛ рд░реВрдкрд╛рдиреНрддрд░рдг рдЧрд░реА LLM рдорд╛ рдкрдард╛рдЙрдБрдЫред

### рдкреБрдирдГрдкреНрд░рд╛рдкреНрддрд┐

рдкреБрдирдГрдкреНрд░рд╛рдкреНрддрд┐ рддрдм рд╣реБрдиреНрдЫ рдЬрдм рдкреНрд░рдгрд╛рд▓реА рдЫрд┐рдЯреЛ рдЦреЛрдЬреА рдорд╛рдкрджрдгреНрдб рдкреВрд░рд╛ рдЧрд░реНрдиреЗ рдХрд╛рдЧрдЬрд╛рддрд╣рд░реВ рдлреЗрд▓рд╛ рдкрд╛рд░реНрди рдЦреЛрдЬреНрдЫред retriever рдХреЛ рд▓рдХреНрд╖реНрдп рддреНрдпрд╕реНрддрд╛ рдХрд╛рдЧрдЬрд╛рддрд╣рд░реВ рд▓реНрдпрд╛рдЙрдиреБ рд╣реЛ рдЬрд╕рд▓реЗ рд╕рдиреНрджрд░реНрдн рдкреНрд░рджрд╛рди рдЧрд░реНрдЫ рд░ рддрдкрд╛рдИрдВрдХреЛ рдбрд╛рдЯрд╛рдорд╛ LLM рд▓рд╛рдИ рдЖрдзрд╛рд░рднреВрдд рдмрдирд╛рдЙрдБрдЫред

рд╣рд╛рдореНрд░реЛ рдбреЗрдЯрд╛рдмреЗрд╕рдорд╛ рдЦреЛрдЬреА рдЧрд░реНрдиреЗ рд╡рд┐рднрд┐рдиреНрди рддрд░рд┐рдХрд╛рд╣рд░реВ рдЫрдиреН:

- **Keyword search** - рдЯреЗрдХреНрд╕реНрдЯ рдЦреЛрдЬреАрдХрд╛ рд▓рд╛рдЧрд┐ рдкреНрд░рдпреЛрдЧ рдЧрд░рд┐рдиреНрдЫред

- **Semantic search** - рд╢рдмреНрджрд╣рд░реВрдХреЛ рдЕрд░реНрде рдкреНрд░рдпреЛрдЧ рдЧрд░реНрдЫред

- **Vector search** - рдХрд╛рдЧрдЬрд╛рддрд╣рд░реВрд▓рд╛рдИ embedding рдореЛрдбреЗрд▓ рдкреНрд░рдпреЛрдЧ рдЧрд░реА рднреЗрдХреНрдЯрд░ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡рдорд╛ рд░реВрдкрд╛рдиреНрддрд░рдг рдЧрд░реНрдЫред рдкреБрдирдГрдкреНрд░рд╛рдкреНрддрд┐ рдкреНрд░рдпреЛрдЧрдХрд░реНрддрд╛рдХреЛ рдкреНрд░рд╢реНрдирд╕рдБрдЧ рд╕рдмреИрднрдиреНрджрд╛ рдирдЬрд┐рдХрдХрд╛ рднреЗрдХреНрдЯрд░ рднрдПрдХрд╛ рдХрд╛рдЧрдЬрд╛рддрд╣рд░реВ рдЦреЛрдЬреЗрд░ рдЧрд░рд┐рдиреНрдЫред

- **Hybrid** - keyword рд░ vector рдЦреЛрдЬреА рджреБрд╡реИрдХреЛ рд╕рдВрдпреЛрдЬрдиред

рдкреБрдирдГрдкреНрд░рд╛рдкреНрддрд┐рдорд╛ рдЪреБрдиреМрддреА рддрдм рдЖрдЙрдБрдЫ рдЬрдм рдбреЗрдЯрд╛рдмреЗрд╕рдорд╛ рдкреНрд░рд╢реНрдирд╕рдБрдЧ рдорд┐рд▓реНрджреЛрдЬреБрд▓реНрджреЛ рдЬрд╡рд╛рдл рд╣реБрдБрджреИрди, рдкреНрд░рдгрд╛рд▓реАрд▓реЗ рд╕рдмреИрднрдиреНрджрд╛ рдЙрдкрдпреБрдХреНрдд рдЬрд╛рдирдХрд╛рд░реА рдлрд░реНрдХрд╛рдЙрдБрдЫред рдпрджреНрдпрдкрд┐, рддрдкрд╛рдИрдВ рд╕рд╛рдиреНрджрд░реНрднрд┐рдХрддрд╛рдХреЛ рдЕрдзрд┐рдХрддрдо рджреВрд░реА рд╕реЗрдЯ рдЧрд░реНрди рд╡рд╛ keyword рд░ vector рдЦреЛрдЬреА рджреБрд╡реИрд▓рд╛рдИ рдорд┐рд▓рд╛рдЙрдиреЗ hybrid рдЦреЛрдЬреА рдкреНрд░рдпреЛрдЧ рдЧрд░реНрди рд╕рдХреНрдиреБрд╣реБрдиреНрдЫред рдпрд╕ рдкрд╛рдардорд╛ рд╣рд╛рдореА hybrid рдЦреЛрдЬреА рдкреНрд░рдпреЛрдЧ рдЧрд░реНрдиреЗрдЫреМрдВ, рдЬрд╕рд▓реЗ рджреБрд╡реИ vector рд░ keyword рдЦреЛрдЬреАрд▓рд╛рдИ рд╕рдВрдпреЛрдЬрди рдЧрд░реНрдЫред рд╣рд╛рдореА рд╣рд╛рдореНрд░реЛ рдбрд╛рдЯрд╛рд▓рд╛рдИ dataframe рдорд╛ рднрдгреНрдбрд╛рд░рдг рдЧрд░реНрдиреЗрдЫреМрдВ рдЬрд╕рдорд╛ chunk рд░ embeddings рджреБрд╡реИ рд╕рдорд╛рд╡реЗрд╢ рд╣реБрдиреЗрдЫрдиреНред

### рднреЗрдХреНрдЯрд░ рд╕рдорд╛рдирддрд╛

retriever рд▓реЗ рдЬреНрдЮрд╛рди рдбреЗрдЯрд╛рдмреЗрд╕рдорд╛ рдирдЬрд┐рдХ рд░рд╣реЗрдХрд╛ embeddings рдЦреЛрдЬреНрдЫ, рд╕рдмреИрднрдиреНрджрд╛ рдирдЬрд┐рдХрдХреЛ рдЫрд┐рдореЗрдХреА, рдХрд┐рдирднрдиреЗ рддреА рдЯреЗрдХреНрд╕реНрдЯрд╣рд░реВ рд╕рдорд╛рди рд╣реБрдиреНрдЫрдиреНред рдкреНрд░рдпреЛрдЧрдХрд░реНрддрд╛рд▓реЗ рдкреНрд░рд╢реНрди рд╕реЛрдзреНрджрд╛, рддреНрдпреЛ рдкрд╣рд┐рд▓реЗ embed рдЧрд░рд┐рдиреНрдЫ рд░ рддреНрдпрд╕рдкрдЫрд┐ рд╕рдорд╛рди embeddings рд╕рдБрдЧ рдорд┐рд▓рд╛рдЗрдиреНрдЫред рд╡рд┐рднрд┐рдиреНрди рднреЗрдХреНрдЯрд░рд╣рд░реВ рдХрддрд┐ рд╕рдорд╛рди рдЫрдиреН рдорд╛рдкрди рдЧрд░реНрди рд╕рд╛рдорд╛рдиреНрдпрддрдпрд╛ cosine similarity рдкреНрд░рдпреЛрдЧ рдЧрд░рд┐рдиреНрдЫ, рдЬреБрди рджреБрдИ рднреЗрдХреНрдЯрд░рдмреАрдЪрдХреЛ рдХреЛрдгрдорд╛ рдЖрдзрд╛рд░рд┐рдд рд╣реБрдиреНрдЫред

рд╣рд╛рдореА рд╕рдорд╛рдирддрд╛ рдорд╛рдкрди рдЧрд░реНрди рдЕрдиреНрдп рд╡рд┐рдХрд▓реНрдкрд╣рд░реВ рдкрдирд┐ рдкреНрд░рдпреЛрдЧ рдЧрд░реНрди рд╕рдХреНрдЫреМрдВ, рдЬрд╕реНрддреИ Euclidean distance рдЬреБрди рднреЗрдХреНрдЯрд░рдХреЛ рдЕрдиреНрддреНрдп рдмрд┐рдиреНрджреБрд╣рд░реВ рдмреАрдЪрдХреЛ рд╕рд┐рдзрд╛ рд░реЗрдЦрд╛ рд╣реЛ рд░ dot product рдЬреБрди рджреБрдИ рднреЗрдХреНрдЯрд░рдХрд╛ рд╕рдореНрдмрдиреНрдзрд┐рдд рддрддреНрддреНрд╡рд╣рд░реВрдХреЛ рдЧреБрдгрдирдлрд▓рдХреЛ рдпреЛрдЧ рд╣реЛред

### рд╕рд░реНрдЪ рдЗрдиреНрдбреЗрдХреНрд╕

рдкреБрдирдГрдкреНрд░рд╛рдкреНрддрд┐ рдЧрд░реНрджрд╛, рд╣рд╛рдореАрд▓реЗ рдЦреЛрдЬреА рдЧрд░реНрдиреБ рдЕрдШрд┐ рд╣рд╛рдореНрд░реЛ рдЬреНрдЮрд╛рди рдЖрдзрд╛рд░рдХреЛ рд▓рд╛рдЧрд┐ рд╕рд░реНрдЪ рдЗрдиреНрдбреЗрдХреНрд╕ рдмрдирд╛рдЙрдиреБрдкрд░реНрдЫред рдЗрдиреНрдбреЗрдХреНрд╕рд▓реЗ рд╣рд╛рдореНрд░реЛ embeddings рднрдгреНрдбрд╛рд░рдг рдЧрд░реНрдЫ рд░ рдареВрд▓реЛ рдбреЗрдЯрд╛рдмреЗрд╕рдорд╛ рдкрдирд┐ рд╕рдмреИрднрдиреНрджрд╛ рд╕рдорд╛рди chunk рдЫрд┐рдЯреЛ рдлреЗрд▓рд╛ рдкрд╛рд░реНрди рд╕рдХреНрдЫред рд╣рд╛рдореА рд╣рд╛рдореНрд░реЛ рдЗрдиреНрдбреЗрдХреНрд╕ рд╕реНрдерд╛рдиреАрдп рд░реВрдкрдорд╛ рдпрд╕рд░реА рдмрдирд╛рдЙрди рд╕рдХреНрдЫреМрдВ:

```python
from sklearn.neighbors import NearestNeighbors

embeddings = flattened_df['embeddings'].to_list()

# Create the search index
nbrs = NearestNeighbors(n_neighbors=5, algorithm='ball_tree').fit(embeddings)

# To query the index, you can use the kneighbors method
distances, indices = nbrs.kneighbors(embeddings)
```

### рдкреБрдирдГрдХреНрд░рдордмрджреНрдз (Re-ranking)

рдбреЗрдЯрд╛рдмреЗрд╕рдорд╛ рдкреНрд░рд╢реНрди рд╕реЛрдзрд┐рд╕рдХреЗрдкрдЫрд┐, рддрдкрд╛рдИрдВрд▓реЗ рдкрд░рд┐рдгрд╛рдорд╣рд░реВ рд╕рдмреИрднрдиреНрджрд╛ рд╕рд╛рдиреНрджрд░реНрднрд┐рдХрдмрд╛рдЯ рдХреНрд░рдордмрджреНрдз рдЧрд░реНрди рдЖрд╡рд╢реНрдпрдХ рдкрд░реНрди рд╕рдХреНрдЫред рдкреБрдирдГрдХреНрд░рдордмрджреНрдз рдЧрд░реНрдиреЗ LLM рд▓реЗ рдореЗрд╢рд┐рди рд▓рд░реНрдирд┐рдЩ рдкреНрд░рдпреЛрдЧ рдЧрд░реА рдЦреЛрдЬреА рдкрд░рд┐рдгрд╛рдорд╣рд░реВрдХреЛ рд╕рд╛рдиреНрджрд░реНрднрд┐рдХрддрд╛ рд╕реБрдзрд╛рд░ рдЧрд░реНрдЫ рд░ рддрд┐рдиреАрд╣рд░реВрд▓рд╛рдИ рд╕рдмреИрднрдиреНрджрд╛ рд╕рд╛рдиреНрджрд░реНрднрд┐рдХрдмрд╛рдЯ рдХреНрд░рдордмрджреНрдз рдЧрд░реНрдЫред Azure AI Search рдкреНрд░рдпреЛрдЧ рдЧрд░реНрджрд╛, рдкреБрдирдГрдХреНрд░рдордмрджреНрдз рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдкрдорд╛ semantic reranker рджреНрд╡рд╛рд░рд╛ рдЧрд░рд┐рдиреНрдЫред рдирдЬрд┐рдХрдХрд╛ рдЫрд┐рдореЗрдХреАрд╣рд░реВ рдкреНрд░рдпреЛрдЧ рдЧрд░реЗрд░ рдкреБрдирдГрдХреНрд░рдордмрджреНрдз рдХрд╕рд░реА рдХрд╛рдо рдЧрд░реНрдЫ рднрдиреНрдиреЗ рдЙрджрд╛рд╣рд░рдг:

```python
# Find the most similar documents
distances, indices = nbrs.kneighbors([query_vector])

index = []
# Print the most similar documents
for i in range(3):
    index = indices[0][i]
    for index in indices[0]:
        print(flattened_df['chunks'].iloc[index])
        print(flattened_df['path'].iloc[index])
        print(flattened_df['distances'].iloc[index])
    else:
        print(f"Index {index} not found in DataFrame")
```

## рд╕рдмреИ рдХреБрд░рд╛ рдПрдХрд╕рд╛рде рд▓реНрдпрд╛рдЙрдБрджреИ

рдЕрдиреНрддрд┐рдо рдЪрд░рдгрдорд╛, рд╣рд╛рдореА рд╣рд╛рдореНрд░реЛ LLM рд▓рд╛рдИ рд╕рдорд╛рд╡реЗрд╢ рдЧрд░реНрдЫреМрдВ рддрд╛рдХрд┐ рд╣рд╛рдореАрд▓реЗ рдкреНрд░рд╛рдкреНрдд рдЧрд░реНрдиреЗ рдЬрд╡рд╛рдлрд╣рд░реВ рд╣рд╛рдореНрд░реЛ рдбрд╛рдЯрд╛рдорд╛ рдЖрдзрд╛рд░рд┐рдд рд╣реБрди рд╕рдХреВрдиреНред рд╣рд╛рдореА рдпрд╕рд▓рд╛рдИ рдпрд╕рд░реА рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдЧрд░реНрди рд╕рдХреНрдЫреМрдВ:

```python
user_input = "what is a perceptron?"

def chatbot(user_input):
    # Convert the question to a query vector
    query_vector = create_embeddings(user_input)

    # Find the most similar documents
    distances, indices = nbrs.kneighbors([query_vector])

    # add documents to query  to provide context
    history = []
    for index in indices[0]:
        history.append(flattened_df['chunks'].iloc[index])

    # combine the history and the user input
    history.append(user_input)

    # create a message object
    messages=[
        {"role": "system", "content": "You are an AI assistant that helps with AI questions."},
        {"role": "user", "content": history[-1]}
    ]

    # use chat completion to generate a response
    response = openai.chat.completions.create(
        model="gpt-4",
        temperature=0.7,
        max_tokens=800,
        messages=messages
    )

    return response.choices[0].message

chatbot(user_input)
```

## рд╣рд╛рдореНрд░реЛ рдПрдкреНрд▓рд┐рдХреЗрд╕рдирдХреЛ рдореВрд▓реНрдпрд╛рдЩреНрдХрди

### рдореВрд▓реНрдпрд╛рдЩреНрдХрди рдореЗрдЯреНрд░рд┐рдХреНрд╕

- рдкреНрд░рджрд╛рди рдЧрд░рд┐рдПрдХрд╛ рдЬрд╡рд╛рдлрд╣рд░реВрдХреЛ рдЧреБрдгрд╕реНрддрд░: рдЬрд╡рд╛рдл рдкреНрд░рд╛рдХреГрддрд┐рдХ, рдкреНрд░рд╡рд╛рд╣рдкреВрд░реНрдг рд░ рдорд╛рдирд╡реАрдп рдЬрд╕реНрддреЛ рд╕реБрдирд┐рдиреНрдЫ рдХрд┐ рдЫреИрдиред

- рдбрд╛рдЯрд╛рдХреЛ рдЖрдзрд╛рд░рднреВрддрддрд╛: рдЬрд╡рд╛рдл рдкреНрд░рджрд╛рди рдЧрд░рд┐рдПрдХреЛ рдХрд╛рдЧрдЬрд╛рддрд╣рд░реВрдмрд╛рдЯ рдЖрдПрдХреЛ рд╣реЛ рдХрд┐ рд╣реЛрдЗрди рдореВрд▓реНрдпрд╛рдЩреНрдХрдиред

- рд╕рд╛рдиреНрджрд░реНрднрд┐рдХрддрд╛: рдЬрд╡рд╛рдл рд╕реЛрдзрд┐рдПрдХреЛ рдкреНрд░рд╢реНрдирд╕рдБрдЧ рдореЗрд▓ рдЦрд╛рдиреНрдЫ рд░ рд╕рдореНрдмрдиреНрдзрд┐рдд рдЫ рдХрд┐ рдЫреИрди рдореВрд▓реНрдпрд╛рдЩреНрдХрдиред

- рдкреНрд░рд╡рд╛рд╣рд╢реАрд▓рддрд╛ - рдЬрд╡рд╛рдл рд╡реНрдпрд╛рдХрд░рдгрд┐рдХ рд░реВрдкрдорд╛ рдмреБрдЭреНрди рдпреЛрдЧреНрдп рдЫ рдХрд┐ рдЫреИрдиред

## RAG (Retrieval Augmented Generation) рд░ рднреЗрдХреНрдЯрд░ рдбреЗрдЯрд╛рдмреЗрд╕рд╣рд░реВ рдкреНрд░рдпреЛрдЧрдХрд╛ рдХреЗрд╕рд╣рд░реВ

рдзреЗрд░реИ рдлрд░рдХ-рдлрд░рдХ рдкреНрд░рдпреЛрдЧрдХрд╛ рдХреЗрд╕рд╣рд░реВ рдЫрдиреН рдЬрд╣рд╛рдБ function calls рд▓реЗ рддрдкрд╛рдИрдВрдХреЛ рдПрдкреНрд▓рд┐рдХреЗрд╕рди рд╕реБрдзрд╛рд░ рдЧрд░реНрди рд╕рдХреНрдЫ, рдЬрд╕реНрддреИ:

- рдкреНрд░рд╢реНрди рд░ рдЙрддреНрддрд░: рддрдкрд╛рдИрдВрдХреЛ рдХрдореНрдкрдиреАрдХреЛ рдбрд╛рдЯрд╛рд▓рд╛рдИ рдЪреНрдпрд╛рдЯрдорд╛ рдЖрдзрд╛рд░рднреВрдд рдмрдирд╛рдЙрдиреЗ рдЬрд╕рд▓рд╛рдИ рдХрд░реНрдордЪрд╛рд░реАрд╣рд░реВрд▓реЗ рдкреНрд░рд╢реНрди рд╕реЛрдзреНрди рдкреНрд░рдпреЛрдЧ рдЧрд░реНрди рд╕рдХреНрдЫрдиреНред

- рд╕рд┐рдлрд╛рд░рд┐рд╕ рдкреНрд░рдгрд╛рд▓реАрд╣рд░реВ: рдЬрд╣рд╛рдБ рддрдкрд╛рдИрдВ рд╕рдмреИрднрдиреНрджрд╛ рдорд┐рд▓реНрджреЛрдЬреБрд▓реНрджреЛ рдорд╛рдирд╣рд░реВ рдЬрд╕реНрддреИ рдЪрд▓рдЪрд┐рддреНрд░, рд░реЗрд╕реНрдЯреБрд░реЗрдиреНрдЯрд╣рд░реВ рдЖрджрд┐ рдорд┐рд▓рд╛рдЙрдиреЗ рдкреНрд░рдгрд╛рд▓реА рдмрдирд╛рдЙрди рд╕рдХреНрдиреБрд╣реБрдиреНрдЫред

- рдЪреНрдпрд╛рдЯрдмреЛрдЯ рд╕реЗрд╡рд╛: рддрдкрд╛рдИрдВрд▓реЗ рдЪреНрдпрд╛рдЯ рдЗрддрд┐рд╣рд╛рд╕ рднрдгреНрдбрд╛рд░рдг рдЧрд░реНрди рд░ рдкреНрд░рдпреЛрдЧрдХрд░реНрддрд╛рдХреЛ рдбрд╛рдЯрд╛рдорд╛ рдЖрдзрд╛рд░рд┐рдд рд╕рдВрд╡рд╛рджрд▓рд╛рдИ рд╡реНрдпрдХреНрддрд┐рдЧрдд рдмрдирд╛рдЙрди рд╕рдХреНрдиреБрд╣реБрдиреНрдЫред

- рднреЗрдХреНрдЯрд░ embeddings рдорд╛ рдЖрдзрд╛рд░рд┐рдд рдЫрд╡рд┐ рдЦреЛрдЬ, рдЫрд╡рд┐ рдкрд╣рд┐рдЪрд╛рди рд░ рдЕрд╕рд╛рдорд╛рдиреНрдпрддрд╛ рдкрддреНрддрд╛ рд▓рдЧрд╛рдЙрди рдЙрдкрдпреЛрдЧреАред

## рд╕рд╛рд░рд╛рдВрд╢

рд╣рд╛рдореАрд▓реЗ RAG рдХрд╛ рдЖрдзрд╛рд░рднреВрдд рдХреНрд╖реЗрддреНрд░рд╣рд░реВ рд╕рдореЗрдЯреНрдпреМрдВ, рдЬрд╕реНрддреИ рд╣рд╛рдореНрд░реЛ рдбрд╛рдЯрд╛ рдПрдкреНрд▓рд┐рдХреЗрд╕рдирдорд╛ рдердкреНрдиреЗ, рдкреНрд░рдпреЛрдЧрдХрд░реНрддрд╛ рдкреНрд░рд╢реНрди рд░ рдЖрдЙрдЯрдкреБрдЯред RAG рд╕рд┐рд░реНрдЬрдирд╛ рд╕рдЬрд┐рд▓реЛ рдмрдирд╛рдЙрди, рддрдкрд╛рдИрдВ Semanti Kernel, Langchain рд╡рд╛ Autogen рдЬрд╕реНрддрд╛ рдлреНрд░реЗрдорд╡рд░реНрдХрд╣рд░реВ рдкреНрд░рдпреЛрдЧ рдЧрд░реНрди рд╕рдХреНрдиреБрд╣реБрдиреНрдЫред

## рдЕрд╕рд╛рдЗрдирдореЗрдиреНрдЯ

Retrieval Augmented Generation (RAG) рдХреЛ рд╕рд┐рдХрд╛рдЗ рдЬрд╛рд░реА рд░рд╛рдЦреНрди рддрдкрд╛рдИрдВрд▓реЗ рдмрдирд╛рдЙрди рд╕рдХреНрдиреБрд╣реБрдиреНрдЫ:

- рдЖрдлреНрдиреЛ рд░реЛрдЬрд╛рдЗрдХреЛ рдлреНрд░реЗрдорд╡рд░реНрдХ рдкреНрд░рдпреЛрдЧ рдЧрд░реА рдПрдкреНрд▓рд┐рдХреЗрд╕рдирдХреЛ рдлреНрд░рдиреНрдЯ-рдПрдиреНрдб рдмрдирд╛рдЙрдиреБрд╣реЛрд╕реНред

- LangChain рд╡рд╛ Semantic Kernel рдордзреНрдпреЗ рдХреБрдиреИ рдПрдХ рдлреНрд░реЗрдорд╡рд░реНрдХ рдкреНрд░рдпреЛрдЧ рдЧрд░реА рдЖрдлреНрдиреЛ рдПрдкреНрд▓рд┐рдХреЗрд╕рди рдкреБрдирдГрдирд┐рд░реНрдорд╛рдг рдЧрд░реНрдиреБрд╣реЛрд╕реНред

рдкрд╛рда рдкреВрд░рд╛ рдЧрд░реНрдиреБрднрдПрдХреЛрдорд╛ рдмрдзрд╛рдИ рдЫ ЁЯСПред

## рд╕рд┐рдХрд╛рдЗ рдпрд╣рд╛рдБ рд░реЛрдХрд┐рдБрджреИрди, рдпрд╛рддреНрд░рд╛ рдЬрд╛рд░реА рд░рд╛рдЦреНрдиреБрд╣реЛрд╕реН

рдпрд╕ рдкрд╛рда рдкреВрд░рд╛ рдЧрд░реЗрдкрдЫрд┐, рд╣рд╛рдореНрд░реЛ [Generative AI Learning collection](https://aka.ms/genai-collection?WT.mc_id=academic-105485-koreyst) рд╣реЗрд░реНрдиреБрд╣реЛрд╕реН рд░ рдЖрдлреНрдиреЛ Generative AI рдЬреНрдЮрд╛рдирд▓рд╛рдИ рдЕрдЭ рдЙрдЪрд╛рдЗрдорд╛ рдкреБрд░реНтАНрдпрд╛рдЙрдиреБрд╣реЛрд╕реН!

**рдЕрд╕реНрд╡реАрдХрд░рдг**:  
рдпреЛ рджрд╕реНрддрд╛рд╡реЗрдЬ AI рдЕрдиреБрд╡рд╛рдж рд╕реЗрд╡рд╛ [Co-op Translator](https://github.com/Azure/co-op-translator) рдкреНрд░рдпреЛрдЧ рдЧрд░реА рдЕрдиреБрд╡рд╛рдж рдЧрд░рд┐рдПрдХреЛ рд╣реЛред рд╣рд╛рдореА рд╢реБрджреНрдзрддрд╛рдХрд╛ рд▓рд╛рдЧрд┐ рдкреНрд░рдпрд╛рд╕рд░рдд рдЫреМрдВ, рддрд░ рдХреГрдкрдпрд╛ рдзреНрдпрд╛рди рджрд┐рдиреБрд╣реЛрд╕реН рдХрд┐ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдЕрдиреБрд╡рд╛рджрдорд╛ рддреНрд░реБрдЯрд┐ рд╡рд╛ рдЕрд╢реБрджреНрдзрддрд╛ рд╣реБрди рд╕рдХреНрдЫред рдореВрд▓ рджрд╕реНрддрд╛рд╡реЗрдЬ рдпрд╕рдХреЛ рдореВрд▓ рднрд╛рд╖рд╛рдорд╛ рдиреИ рдЕрдзрд┐рдХрд╛рд░рд┐рдХ рд╕реНрд░реЛрдд рдорд╛рдирд┐рдиреБрдкрд░реНрдЫред рдорд╣рддреНрд╡рдкреВрд░реНрдг рдЬрд╛рдирдХрд╛рд░реАрдХрд╛ рд▓рд╛рдЧрд┐ рд╡реНрдпрд╛рд╡рд╕рд╛рдпрд┐рдХ рдорд╛рдирд╡ рдЕрдиреБрд╡рд╛рдж рд╕рд┐рдлрд╛рд░рд┐рд╕ рдЧрд░рд┐рдиреНрдЫред рдпрд╕ рдЕрдиреБрд╡рд╛рджрдХреЛ рдкреНрд░рдпреЛрдЧрдмрд╛рдЯ рдЙрддреНрдкрдиреНрди рдХреБрдиреИ рдкрдирд┐ рдЧрд▓рддрдлрд╣рдореА рд╡рд╛ рдЧрд▓рдд рд╡реНрдпрд╛рдЦреНрдпрд╛рдХрд╛ рд▓рд╛рдЧрд┐ рд╣рд╛рдореА рдЬрд┐рдореНрдореЗрд╡рд╛рд░ рдЫреИрдиреМрдВред